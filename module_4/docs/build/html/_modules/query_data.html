<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>query_data &#8212; GradCafe Analytics 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for query_data</h1><div class="highlight"><pre>
<span></span><span class="c1"># This is used to query the data and has all of the SQL commands and explanation/logic loaded into List</span>
<span class="c1">#</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">db</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_cursor</span>

<div class="viewcode-block" id="q_all">
<a class="viewcode-back" href="../api.html#query_data.q_all">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">q_all</span><span class="p">(</span><span class="n">sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
    <span class="k">with</span> <span class="n">get_cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span></div>


<div class="viewcode-block" id="format_percentage">
<a class="viewcode-back" href="../api.html#query_data.format_percentage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">format_percentage</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper to add % sign if value exists&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">%&quot;</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;0%&quot;</span></div>


<div class="viewcode-block" id="get_analysis">
<a class="viewcode-back" href="../api.html#query_data.get_analysis">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_analysis</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="n">analysis</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># --- Questions 1-9 (Required) ---</span>

    <span class="c1"># Q1</span>
    <span class="n">q1_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) FROM applicants WHERE term LIKE &#39;Fall 2025%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q1_sql</span><span class="p">)</span>
    <span class="n">ans1</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;How many total applications were submitted for the Fall 2025 term?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans1</span><span class="si">}</span><span class="s2"> applications&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q1_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Counts all rows where the term starts with &#39;Fall 2025&#39;.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q2</span>
 <span class="c1"># Q2 (UPDATED FOR SAFETY)</span>
    <span class="n">q2_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            CASE </span>
<span class="s2">                WHEN (SELECT COUNT(*) FROM applicants) = 0 THEN 0</span>
<span class="s2">                ELSE ROUND(100.0 * COUNT(*) / (SELECT COUNT(*) FROM applicants), 2)</span>
<span class="s2">            END</span>
<span class="s2">        FROM applicants </span>
<span class="s2">        WHERE us_or_international NOT IN (&#39;American&#39;, &#39;Other&#39;);</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q2_sql</span><span class="p">)</span>
    <span class="n">ans2</span> <span class="o">=</span> <span class="n">format_percentage</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="s2">&quot;0%&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;What percentage of all applicants are international (non-American)?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="n">ans2</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q2_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Calculates the ratio of applicants who are not &#39;American&#39; or &#39;Other&#39; against the total count.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q3</span>
    <span class="n">q3_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT ROUND(AVG(gpa)::numeric, 2), ROUND(AVG(gre)::numeric, 2), ROUND(AVG(gre_v)::numeric, 2), ROUND(AVG(gre_aw)::numeric, 2) FROM applicants;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q3_sql</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rows</span> <span class="ow">and</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">gpa</span><span class="p">,</span> <span class="n">gre</span><span class="p">,</span> <span class="n">gre_v</span><span class="p">,</span> <span class="n">gre_aw</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ans3</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GPA: </span><span class="si">{</span><span class="n">gpa</span><span class="si">}</span><span class="s2"> | GRE Quant: </span><span class="si">{</span><span class="n">gre</span><span class="si">}</span><span class="s2"> | GRE Verbal: </span><span class="si">{</span><span class="n">gre_v</span><span class="si">}</span><span class="s2"> | GRE AW: </span><span class="si">{</span><span class="n">gre_aw</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ans3</span> <span class="o">=</span> <span class="s2">&quot;No data available&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;What are the average GPA and GRE scores (Quant, Verbal, AW) across the entire dataset?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="n">ans3</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q3_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Computes the average for GPA and all GRE sections, rounding to 2 decimal places.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q4</span>
    <span class="n">q4_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT ROUND(AVG(gpa)::numeric, 2) FROM applicants WHERE us_or_international = &#39;American&#39; AND term LIKE &#39;Fall 2025%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q4_sql</span><span class="p">)</span>
    <span class="n">ans4</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="ow">and</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;No data&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;What is the average GPA of American students who applied for Fall 2025?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans4</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q4_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Filters for American students in Fall 2025 and averages their GPA.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q5</span>
 
 <span class="c1"># Q5 (UPDATED FOR SAFETY)</span>
    <span class="n">q5_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            CASE </span>
<span class="s2">                WHEN (SELECT COUNT(*) FROM applicants WHERE term LIKE &#39;Fall 2025%&#39;) = 0 THEN 0</span>
<span class="s2">                ELSE ROUND(100.0 * COUNT(*) / (SELECT COUNT(*) FROM applicants WHERE term LIKE &#39;Fall 2025%&#39;), 2)</span>
<span class="s2">            END</span>
<span class="s2">        FROM applicants </span>
<span class="s2">        WHERE status = &#39;Accepted&#39; AND term LIKE &#39;Fall 2025%&#39;;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q5_sql</span><span class="p">)</span>
    <span class="n">ans5</span> <span class="o">=</span> <span class="n">format_percentage</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="s2">&quot;0%&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;What is the overall acceptance rate for the Fall 2025 term?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="n">ans5</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q5_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Divides the number of &#39;Accepted&#39; students by the total number of applicants for Fall 2025.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q6</span>
    <span class="n">q6_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT ROUND(AVG(gpa)::numeric, 2) FROM applicants WHERE status = &#39;Accepted&#39; AND term LIKE &#39;Fall 2025%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q6_sql</span><span class="p">)</span>
    <span class="n">ans6</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="ow">and</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;No data&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;What is the average GPA of students who were accepted for Fall 2025?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans6</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q6_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Averages the GPA only for students with &#39;Accepted&#39; status in Fall 2025.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q7</span>
    <span class="n">q7_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) FROM applicants WHERE (university ILIKE &#39;%JHU%&#39; OR university ILIKE &#39;%Johns Hopkins%&#39;) AND degree = &#39;Masters&#39; AND program ILIKE &#39;%Computer Science%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q7_sql</span><span class="p">)</span>
    <span class="n">ans7</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;How many applicants for a Masters in Computer Science applied to Johns Hopkins (JHU)?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans7</span><span class="si">}</span><span class="s2"> applicants&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q7_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Filters for JHU (using wildcards) and Masters CS programs.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q8</span>
    <span class="n">q8_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) FROM applicants WHERE EXTRACT(YEAR FROM date_added) = 2025 AND status = &#39;Accepted&#39; AND university IN (&#39;Georgetown University&#39;, &#39;MIT&#39;, &#39;Stanford University&#39;, &#39;Carnegie Mellon University&#39;) AND degree = &#39;PhD&#39; AND program ILIKE &#39;%Computer Science%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q8_sql</span><span class="p">)</span>
    <span class="n">ans8</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;Using original fields: How many CS PhD applicants were accepted to Georgetown, MIT, Stanford, or CMU in 2025?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans8</span><span class="si">}</span><span class="s2"> applicants&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q8_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;JUSTIFICATION: We used the &#39;date_added&#39; field because the question asks for acceptances &#39;in 2025&#39; (the calendar year the result was received), rather than &#39;for the term of 2025&#39;. This distinguishes immediate results from future term starts.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q9</span>
    <span class="n">q9_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) FROM applicants WHERE EXTRACT(YEAR FROM date_added) = 2025 AND status = &#39;Accepted&#39; AND llm_generated_university IN (&#39;Georgetown University&#39;, &#39;MIT&#39;, &#39;Stanford University&#39;, &#39;Carnegie Mellon University&#39;) AND degree = &#39;PhD&#39; AND llm_generated_program ILIKE &#39;%Computer Science%&#39;;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q9_sql</span><span class="p">)</span>
    <span class="n">ans9</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q9&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;Using LLM fields: How many CS PhD applicants were accepted to Georgetown, MIT, Stanford, or CMU in 2025?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ans9</span><span class="si">}</span><span class="s2"> applicants&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q9_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;JUSTIFICATION: Same logic as Q8 (using &#39;date_added&#39; for calendar year). We use the LLM-cleaned university names here to capture variations like &#39;Carnegie Mellon&#39; vs &#39;CMU&#39;.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># --- Extra Questions (10 &amp; 11) ---</span>

    <span class="c1"># Q10</span>
    <span class="n">q10_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT llm_generated_program, COUNT(*) as count FROM applicants GROUP BY 1 ORDER BY 2 DESC LIMIT 1;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q10_sql</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">prog</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ans10</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prog</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> applications)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ans10</span> <span class="o">=</span> <span class="s2">&quot;No data&quot;</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;Extra Q1: Which academic program has the highest volume of application entries?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="n">ans10</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q10_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Groups by program name and sorts descending to find the most popular one.&quot;</span>
    <span class="p">})</span>

    <span class="c1"># Q11</span>
    <span class="n">q11_sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT degree, ROUND(AVG(gre)::numeric, 2) as avg_q FROM applicants WHERE degree IN (&#39;PhD&#39;, &#39;Masters&#39;) GROUP BY 1;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">q_all</span><span class="p">(</span><span class="n">q11_sql</span><span class="p">)</span>
    
    <span class="c1"># Format list into a readable string</span>
    <span class="k">if</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">degree_name</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">degree_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ans11</span> <span class="o">=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ans11</span> <span class="o">=</span> <span class="s2">&quot;No data&quot;</span>

    <span class="n">analysis</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;q11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="s2">&quot;Extra Q2: How does the average GRE Quantitative score compare between PhD and Masters applicants?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="n">ans11</span><span class="p">,</span>
        <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="n">q11_sql</span><span class="p">,</span>
        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="s2">&quot;Groups by degree type to compare average GRE scores side-by-side.&quot;</span>
    <span class="p">})</span>

    <span class="k">return</span> <span class="n">analysis</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">get_analysis</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;question&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;answer&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">GradCafe Analytics</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, Eugene Buyanovsky.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>